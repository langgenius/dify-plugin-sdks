identity:
  name: gmail_message
  author: langgenius
  label:
    en_US: Gmail Message (Unified)
    zh_Hans: Gmail 消息（统一）
    ja_JP: Gmail メッセージ（統合）

description:
  en_US: Unified Gmail message event based on history delta. Returns new messages since last checkpoint.
  zh_Hans: 基于历史增量的统一 Gmail 消息事件，返回自上次位点以来的新邮件。
  ja_JP: 履歴差分に基づく Gmail メッセージ統合イベント。前回チェックポイント以降の新規メッセージを返します。

parameters:
- name: from_contains
  label:
    en_US: From Contains
    zh_Hans: 发件人包含
    ja_JP: 差出人に含む
  type: string
  required: false
  description:
    en_US: Comma-separated keywords. Any match in the From header passes.
    zh_Hans: 逗号分隔关键字。任一命中发件人 From 头即通过。
    ja_JP: カンマ区切りキーワード。From ヘッダ内にいずれかが含まれれば通過。

- name: to_contains
  label:
    en_US: To Contains
    zh_Hans: 收件人包含
    ja_JP: 宛先に含む
  type: string
  required: false
  description:
    en_US: Comma-separated keywords. Any match in the To header passes.
    zh_Hans: 逗号分隔关键字。任一命中收件人 To 头即通过。
    ja_JP: カンマ区切りキーワード。To ヘッダ内にいずれかが含まれれば通過。

- name: subject_contains
  label:
    en_US: Subject Contains
    zh_Hans: 主题包含
    ja_JP: 件名に含む
  type: string
  required: false
  description:
    en_US: Comma-separated keywords. Any match in Subject passes.
    zh_Hans: 逗号分隔关键字。任一命中主题即通过。
    ja_JP: カンマ区切りキーワード。件名にいずれかが含まれれば通過。

- name: has_attachments
  label:
    en_US: Has Attachments
    zh_Hans: 包含附件
    ja_JP: 添付あり
  type: boolean
  required: false
  description:
    en_US: If true, only messages with attachments pass. If false, only messages without attachments pass. If unset, no filter.
    zh_Hans: 为 true 仅保留有附件的邮件，为 false 仅保留无附件邮件，不设置则不过滤。
    ja_JP: true の場合は添付ありのみ、false の場合は添付なしのみ。未設定ならフィルタしません。

extra:
  python:
    source: events/gmail_message/gmail_message.py

output_schema:
  type: object
  properties:
    email_address:
      type: string
      description: Gmail email address associated to the notification
    history_id:
      type: string
      description: Latest history id seen by this event
    messages:
      type: array
      items:
        type: object
        properties:
          id:
            type: string
          threadId:
            type: string
          internalDate:
            type: string
          snippet:
            type: string
          sizeEstimate:
            type: integer
          labelIds:
            type: array
            items:
              type: string
          headers:
            type: object
            properties:
              From:
                type: string
              To:
                type: string
              Subject:
                type: string
              Date:
                type: string
              Message-Id:
                type: string
          has_attachments:
            type: boolean
          attachments:
            type: array
            items:
              type: object
              properties:
                filename:
                  type: string
                mimeType:
                  type: string
                size:
                  type:
                  - integer
                  - "null"

