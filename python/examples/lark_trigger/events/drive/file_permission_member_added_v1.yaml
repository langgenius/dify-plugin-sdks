identity:
  name: file_permission_member_added_v1
  author: langgenius
  label:
    en_US: Drive Access Granted
    zh_Hans: 云文档共享权限新增
    ja_JP: ドライブ権限追加

description:
  en_US: Fires when sharing permissions are granted on a Drive file, returning details about users, chats, and departments receiving access.
  zh_Hans: 当云文档授予共享权限时触发，返回获得访问权限的用户、群聊和部门信息。
  ja_JP: ドライブファイルに共有権限が付与された際に発火し、アクセス権を得たユーザー、チャット、部門の詳細を提供します。

parameters: []

output_schema:
  type: object
  properties:
    file_token:
      type: string
      description: Token of the shared file

    file_type:
      type: string
      description: File type (doc, sheet, slide, etc.)

    operator_user_id:
      type: string
      description: User ID of the operator who granted access

    operator_open_id:
      type: string
      description: Open ID of the operator

    operator_union_id:
      type: string
      description: Union ID of the operator

    shared_users:
      type: array
      description: Users granted access
      items:
        type: object
        properties:
          user_id:
            type: string
            description: User ID
          open_id:
            type: string
            description: Open ID
          union_id:
            type: string
            description: Union ID

    shared_user_count:
      type: integer
      description: Number of users who gained access

    shared_chats:
      type: array
      description: Chat IDs that received access
      items:
        type: string

    shared_departments:
      type: array
      description: Department IDs that received access
      items:
        type: string

    subscriber_users:
      type: array
      description: Subscribers of the file
      items:
        type: object
        properties:
          user_id:
            type: string
            description: User ID
          open_id:
            type: string
            description: Open ID
          union_id:
            type: string
            description: Union ID

    subscriber_count:
      type: integer
      description: Number of subscribers receiving the update

extra:
  python:
    source: events/drive/file_permission_member_added_v1.py
