identity:
  name: ref_change
  author: langgenius
  label:
    en_US: Ref Change (Create/Delete)
    zh_Hans: 引用变更（创建/删除）
    ja_JP: リファレンス変更（作成/削除）

description:
  en_US: Unified event for branch/tag create and delete
  zh_Hans: 统一的分支/标签创建与删除事件
  ja_JP: ブランチ/タグの作成・削除を統合

parameters:
- name: event_types
  label:
    en_US: Event Types
    zh_Hans: 事件类型
    ja_JP: イベントタイプ
  type: select
  required: false
  multiple: true
  default:
  - create
  - delete
  options:
  - value: create
    label:
      en_US: Create
      zh_Hans: 创建
      ja_JP: 作成
  - value: delete
    label:
      en_US: Delete
      zh_Hans: 删除
      ja_JP: 削除

- name: ref_type
  label:
    en_US: Ref Type
    zh_Hans: 引用类型
    ja_JP: リファレンスタイプ
  type: select
  required: false
  options:
  - value: branch
    label:
      en_US: Branch
      zh_Hans: 分支
      ja_JP: ブランチ
  - value: tag
    label:
      en_US: Tag
      zh_Hans: 标签
      ja_JP: タグ

- name: ref_names
  label:
    en_US: Ref Names
    zh_Hans: 引用名称
    ja_JP: リファレンス名
  type: string
  required: false
  description:
    en_US: Only trigger for these ref names (comma-separated)
    zh_Hans: 仅对这些引用名触发（逗号分隔）
    ja_JP: これらのリファレンス名の場合のみトリガー（カンマ区切り）

output_schema:
  type: object
  properties:
    action:
      type: string
      description: created or deleted
    ref:
      type: string
    ref_type:
      type: string
      enum:
      - branch
      - tag
    master_branch:
      type: string
    repository:
      type: object
      description: The repository where the ref changed
      properties:
        id:
          type: integer
          format: int64
        node_id:
          type: string
        name:
          type: string
        full_name:
          type: string
        private:
          type: boolean
        owner:
          type: object
          properties:
            id:
              type: integer
            login:
              type: string
            node_id:
              type: string
            avatar_url:
              type: string
              format: uri
            html_url:
              type: string
              format: uri
            type:
              type: string
              enum:
              - Bot
              - User
              - Organization
            site_admin:
              type: boolean
          required:
          - id
          - login
        html_url:
          type: string
          format: uri
        description:
          type:
          - string
          - "null"
        fork:
          type: boolean
        url:
          type: string
          format: uri
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
        pushed_at:
          type:
          - string
          - "null"
          format: date-time
        stargazers_count:
          type: integer
        watchers_count:
          type: integer
        language:
          type:
          - string
          - "null"
        forks_count:
          type: integer
        open_issues_count:
          type: integer
        default_branch:
          type: string
        topics:
          type: array
          items:
            type: string
        visibility:
          type: string
          enum:
          - public
          - private
          - internal
      required:
      - id
      - node_id
      - name
      - full_name
      - private
      - owner
      - html_url
      - url
      - created_at
      - updated_at
      - fork
      - default_branch
      - visibility
    sender:
      type: object
      description: The user who triggered the event
      properties:
        id:
          type: integer
        login:
          type: string
        node_id:
          type: string
        avatar_url:
          type: string
          format: uri
        html_url:
          type: string
          format: uri
        type:
          type: string
          enum:
          - Bot
          - User
          - Organization
        site_admin:
          type: boolean
      required:
      - id
      - login
      - type

  required:
  - action
  - ref
  - ref_type
  - repository
  - sender

extra:
  python:
    source: events/ref_change/ref_change.py
