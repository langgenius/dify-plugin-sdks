identity:
  name: release_published
  author: langgenius
  label:
    en_US: Release Published
    zh_Hans: 发布已发布
    ja_JP: リリース公開

description:
  en_US: Triggers when a release is published
  zh_Hans: 当发布被正式发布时触发
  ja_JP: リリースが公開されたときにトリガーします

parameters:
- name: tag_name
  label:
    en_US: Tag Name
    zh_Hans: 标签名
    ja_JP: タグ名
  type: string
  required: false
  description:
    en_US: "Only trigger for these tag names (comma-separated)."
    zh_Hans: "仅当标签名匹配时触发（逗号分隔）。"
    ja_JP: "これらのタグ名の場合のみトリガー（カンマ区切り）。"

- name: target_branch
  label:
    en_US: Target Branch
    zh_Hans: 目标分支
    ja_JP: 対象ブランチ
  type: string
  required: false
  description:
    en_US: "Only trigger if the release targets these branches (comma-separated)."
    zh_Hans: "仅当发布目标为这些分支时触发（逗号分隔）。"
    ja_JP: "リリースの対象がこれらのブランチの場合のみトリガー（カンマ区切り）。"

- name: prerelease
  label:
    en_US: Is Prerelease
    zh_Hans: 是否为预发布
    ja_JP: プレリリースか
  type: boolean
  required: false
  description:
    en_US: "Filter by prerelease flag: true only for prereleases, false only for non-prereleases."
    zh_Hans: "按预发布标志过滤：true 仅预发布，false 仅正式发布。"
    ja_JP: "プレリリースフラグでフィルタ：true はプレリリースのみ、false は正式リリースのみ。"

- name: draft
  label:
    en_US: Is Draft
    zh_Hans: 是否为草稿
    ja_JP: 下書きか
  type: boolean
  required: false
  description:
    en_US: "Filter by draft flag: true only for draft releases, false only for non-draft."
    zh_Hans: "按草稿标志过滤：true 仅草稿发布，false 仅非草稿。"
    ja_JP: "ドラフトフラグでフィルタ：true は下書きのみ、false は非下書きのみ。"

- name: creator
  label:
    en_US: Creator
    zh_Hans: 创建者
    ja_JP: 作成者
  type: string
  required: false
  description:
    en_US: "Only trigger if created by these users (comma-separated GitHub usernames)."
    zh_Hans: "仅当由这些用户创建时触发（逗号分隔 GitHub 用户名）。"
    ja_JP: "これらのユーザーによって作成された場合のみトリガー（GitHub ユーザー名、カンマ区切り）。"

output_schema:
  type: object
  properties:
    action:
      type: string
    release:
      type: object
      properties:
        id:
          type: integer
        tag_name:
          type: string
        target_commitish:
          type: string
        name:
          type: string
        body:
          type: string
        draft:
          type: boolean
        prerelease:
          type: boolean
        created_at:
          type: string
          format: date-time
        published_at:
          type:
          - string
          - "null"
          format: date-time
        html_url:
          type: string
          format: uri
        author:
          type: object
          properties:
            id:
              type: integer
            login:
              type: string
        assets:
          type: array
          items:
            type: object
            properties:
              id:
                type: integer
              name:
                type: string
              label:
                type:
                - string
                - "null"
              state:
                type: string
              size:
                type: integer
              download_count:
                type: integer
              browser_download_url:
                type: string
                format: uri
      required:
      - id
      - tag_name
      - target_commitish
      - draft
      - prerelease
    repository:
      type: object
      description: The repository where the release was published
      properties:
        id:
          type: integer
          format: int64
        node_id:
          type: string
        name:
          type: string
        full_name:
          type: string
        private:
          type: boolean
        owner:
          type: object
          properties:
            id:
              type: integer
            login:
              type: string
            node_id:
              type: string
            avatar_url:
              type: string
              format: uri
            html_url:
              type: string
              format: uri
            type:
              type: string
              enum:
              - Bot
              - User
              - Organization
            site_admin:
              type: boolean
          required:
          - id
          - login
        html_url:
          type: string
          format: uri
        description:
          type:
          - string
          - "null"
        fork:
          type: boolean
        url:
          type: string
          format: uri
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
        pushed_at:
          type:
          - string
          - "null"
          format: date-time
        stargazers_count:
          type: integer
        watchers_count:
          type: integer
        language:
          type:
          - string
          - "null"
        forks_count:
          type: integer
        open_issues_count:
          type: integer
        default_branch:
          type: string
        topics:
          type: array
          items:
            type: string
        visibility:
          type: string
          enum:
          - public
          - private
          - internal
      required:
      - id
      - node_id
      - name
      - full_name
      - private
      - owner
      - html_url
      - url
      - created_at
      - updated_at
      - fork
      - default_branch
      - visibility
    sender:
      type: object
      description: The user who triggered the event
      properties:
        id:
          type: integer
        login:
          type: string
        node_id:
          type: string
        avatar_url:
          type: string
          format: uri
        html_url:
          type: string
          format: uri
        type:
          type: string
          enum:
          - Bot
          - User
          - Organization
        site_admin:
          type: boolean
      required:
      - id
      - login
      - type

  required:
  - action
  - release
  - repository
  - sender

extra:
  python:
    source: events/release/release_published.py
