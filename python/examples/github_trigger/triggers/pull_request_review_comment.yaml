identity:
  name: pull_request_review_comment
  author: langgenius
  label:
    en_US: Pull Request Review Comment
    zh_Hans: Pull Request 审查评论
    pt_BR: Comentário de Revisão de Pull Request

description:
  human:
    en_US: Triggers on pull request review comment events (created, edited, deleted)
    zh_Hans: 在 pull request 审查评论事件时触发（创建、编辑、删除）
    pt_BR: Dispara em eventos de comentário de revisão de pull request (criado, editado, excluído)
  llm:
    en_US: This trigger activates on GitHub pull request review comment events, providing comprehensive information about the comment, review, pull request, repository, and involved users.
    zh_Hans: 此触发器在 GitHub pull request 审查评论事件时激活，提供有关评论、审查、pull request、仓库和相关用户的综合信息。
    pt_BR: Este gatilho é ativado em eventos de comentário de revisão de pull request do GitHub, fornecendo informações abrangentes sobre o comentário, revisão, pull request, repositório e usuários envolvidos.

parameters:
  - name: action_filter
    label:
      en_US: Action Filter
      zh_Hans: 操作过滤
      pt_BR: Filtro de Ação
    type: select
    required: false
    options:
      - value: created
        label:
          en_US: Created
          zh_Hans: 创建
          pt_BR: Criado
      - value: edited
        label:
          en_US: Edited
          zh_Hans: 编辑
          pt_BR: Editado
      - value: deleted
        label:
          en_US: Deleted
          zh_Hans: 删除
          pt_BR: Excluído
    multiple: true
    help:
      en_US: "Select which comment actions to trigger on (leave empty for all)"
      zh_Hans: "选择触发的评论操作（留空表示所有）"
      pt_BR: "Selecione quais ações de comentário devem disparar (deixe vazio para todas)"

  - name: author_type
    label:
      en_US: Author Type Filter
      zh_Hans: 作者类型过滤
      pt_BR: Filtro de Tipo de Autor
    type: select
    required: false
    options:
      - value: human_only
        label:
          en_US: Human Only (exclude bots)
          zh_Hans: 仅人类（排除机器人）
          pt_BR: Apenas Humanos (excluir bots)
      - value: bot_only
        label:
          en_US: Bot Only
          zh_Hans: 仅机器人
          pt_BR: Apenas Bots
    help:
      en_US: "Filter comments by author type"
      zh_Hans: "按作者类型过滤评论"
      pt_BR: "Filtrar comentários por tipo de autor"

  - name: required_commenters
    label:
      en_US: Required Commenters
      zh_Hans: 必需评论者
      pt_BR: Comentaristas Obrigatórios
    type: string
    required: false
    placeholder:
      en_US: "e.g., john-doe, jane-smith, @team-leads (comma-separated)"
      zh_Hans: "例如：john-doe, jane-smith, @team-leads（逗号分隔）"
      pt_BR: "ex: john-doe, jane-smith, @team-leads (separados por vírgula)"
    help:
      en_US: "Only trigger if comment is from one of these users/teams"
      zh_Hans: "仅当评论来自这些用户/团队之一时触发"
      pt_BR: "Disparar apenas se o comentário for de um destes usuários/equipes"

  - name: target_branches
    label:
      en_US: Target Branch Filter
      zh_Hans: 目标分支过滤
      pt_BR: Filtro de Branch de Destino
    type: string
    required: false
    placeholder:
      en_US: "e.g., main, release/*, production (comma-separated, supports wildcards)"
      zh_Hans: "例如：main, release/*, production（逗号分隔，支持通配符）"
      pt_BR: "ex: main, release/*, production (separados por vírgula, suporta wildcards)"
    help:
      en_US: "Only trigger for comments on PRs targeting these branches"
      zh_Hans: "仅对目标为这些分支的 PR 评论触发"
      pt_BR: "Disparar apenas para comentários em PRs direcionados a essas branches"

  - name: labels
    label:
      en_US: Label Filter
      zh_Hans: 标签过滤
      pt_BR: Filtro de Etiquetas
    type: string
    required: false
    placeholder:
      en_US: "e.g., needs-review, critical, security (comma-separated)"
      zh_Hans: "例如：needs-review, critical, security（逗号分隔）"
      pt_BR: "ex: needs-review, critical, security (separados por vírgula)"
    help:
      en_US: "Only trigger for comments on PRs with these labels"
      zh_Hans: "仅对带有这些标签的 PR 评论触发"
      pt_BR: "Disparar apenas para comentários em PRs com essas etiquetas"

  - name: exclude_pr_authors
    label:
      en_US: Exclude PR Authors
      zh_Hans: 排除 PR 作者
      pt_BR: Excluir Autores de PR
    type: string
    required: false
    placeholder:
      en_US: "e.g., dependabot[bot], renovate[bot] (comma-separated)"
      zh_Hans: "例如：dependabot[bot], renovate[bot]（逗号分隔）"
      pt_BR: "ex: dependabot[bot], renovate[bot] (separados por vírgula)"
    help:
      en_US: "Ignore comments on PRs from these authors"
      zh_Hans: "忽略来自这些作者的 PR 上的评论"
      pt_BR: "Ignorar comentários em PRs desses autores"

  - name: min_body_length
    label:
      en_US: Minimum Comment Body Length
      zh_Hans: 最少评论内容长度
      pt_BR: Comprimento Mínimo do Corpo do Comentário
    type: number
    required: false
    placeholder:
      en_US: "e.g., 10 (minimum characters for meaningful comment)"
      zh_Hans: "例如：10（有意义评论的最少字符数）"
      pt_BR: "ex: 10 (caracteres mínimos para comentário significativo)"
    help:
      en_US: "Only trigger if comment body has at least this many characters"
      zh_Hans: "仅当评论内容至少有这么多字符时触发"
      pt_BR: "Disparar apenas se o corpo do comentário tiver pelo menos este número de caracteres"

  - name: mention_keywords
    label:
      en_US: Mention Keywords
      zh_Hans: 提及关键词
      pt_BR: Palavras-chave de Menção
    type: string
    required: false
    placeholder:
      en_US: "e.g., @reviewer, security, urgent (comma-separated)"
      zh_Hans: "例如：@reviewer, security, urgent（逗号分隔）"
      pt_BR: "ex: @reviewer, security, urgent (separados por vírgula)"
    help:
      en_US: "Only trigger if comment mentions these keywords"
      zh_Hans: "仅当评论提及这些关键词时触发"
      pt_BR: "Disparar apenas se o comentário mencionar essas palavras-chave"

output_schema:
  type: object
  properties:
    action:
      type: string
      description: The action that was performed on the comment
    comment:
      type: object
      properties:
        id:
          type: number
          description: The comment ID
        body:
          type: string
          description: The comment body/text
        html_url:
          type: string
          description: The URL to view the comment on GitHub
        created_at:
          type: string
          description: When the comment was created
        updated_at:
          type: string
          description: When the comment was last updated
        author:
          type: object
          properties:
            login:
              type: string
              description: The username of the comment author
            avatar_url:
              type: string
              description: The avatar URL of the comment author
            html_url:
              type: string
              description: The profile URL of the comment author
            type:
              type: string
              description: The type of the comment author (User, Bot, etc.)
        diff_hunk:
          type: string
          description: The diff hunk the comment is associated with
        path:
          type: string
          description: The file path the comment is on
        position:
          type: number
          description: The position in the diff where the comment was made
        original_position:
          type: number
          description: The original position in the diff
        commit_id:
          type: string
          description: The commit SHA the comment is associated with
        original_commit_id:
          type: string
          description: The original commit SHA
        line:
          type: number
          description: The line number in the file
        original_line:
          type: number
          description: The original line number
        side:
          type: string
          description: The side of the diff (LEFT or RIGHT)
        start_line:
          type: number
          description: The start line of a multi-line comment
        start_side:
          type: string
          description: The side of the start line
        in_reply_to_id:
          type: number
          description: The ID of the comment this is a reply to
    pull_request:
      type: object
      properties:
        number:
          type: number
          description: The pull request number
        title:
          type: string
          description: The pull request title
        body:
          type: string
          description: The pull request description
        state:
          type: string
          description: The pull request state
        html_url:
          type: string
          description: The URL to view the pull request on GitHub
        created_at:
          type: string
          description: When the pull request was created
        updated_at:
          type: string
          description: When the pull request was last updated
        draft:
          type: boolean
          description: Whether the pull request is a draft
        labels:
          type: array
          description: Labels attached to the pull request
          items:
            type: object
            properties:
              name:
                type: string
                description: Label name
              color:
                type: string
                description: Label color
              description:
                type: string
                description: Label description
        assignees:
          type: array
          description: Users assigned to the pull request
          items:
            type: object
            properties:
              login:
                type: string
                description: Assignee username
              avatar_url:
                type: string
                description: Assignee avatar URL
              html_url:
                type: string
                description: Assignee profile URL
        author:
          type: object
          properties:
            login:
              type: string
              description: The username of the pull request author
            avatar_url:
              type: string
              description: The avatar URL of the pull request author
            html_url:
              type: string
              description: The profile URL of the pull request author
        head:
          type: object
          properties:
            ref:
              type: string
              description: The head branch name
            sha:
              type: string
              description: The head commit SHA
            repo_name:
              type: string
              description: The head repository name
        base:
          type: object
          properties:
            ref:
              type: string
              description: The base branch name
            sha:
              type: string
              description: The base commit SHA
            repo_name:
              type: string
              description: The base repository name
    repository:
      type: object
      properties:
        name:
          type: string
          description: The repository name
        full_name:
          type: string
          description: The full repository name (owner/repo)
        html_url:
          type: string
          description: The repository URL
        description:
          type: string
          description: The repository description
        private:
          type: boolean
          description: Whether the repository is private
        owner:
          type: object
          properties:
            login:
              type: string
              description: Repository owner username
            avatar_url:
              type: string
              description: Repository owner avatar URL
            html_url:
              type: string
              description: Repository owner profile URL
    sender:
      type: object
      properties:
        login:
          type: string
          description: The username who triggered the event
        avatar_url:
          type: string
          description: The avatar URL of the sender
        html_url:
          type: string
          description: The profile URL of the sender
        type:
          type: string
          description: The type of the sender (User, Bot, etc.)
    changes:
      type: object
      description: Changes made (only for edited action)
      properties:
        body:
          type: object
          properties:
            from:
              type: string
              description: Previous comment body

extra:
  python:
    source: triggers/pull_request_review_comment.py